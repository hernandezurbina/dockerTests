<!DOCTYPE html>
<html lang="en">

<head>
	<title>NTG</title>
	<meta charset="utf-8" />
	{% load staticfiles %}
	<link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}" type = "text/css"/>

	<meta name="viewport" content = "width=device-width, initial-scale=1.0">

	<style type="text/css">
		html,
		body {
	  	height: 100%;
	  	margin: 0
		}

		.box {
	  	display: flex;
	  	height: 100%;
		}

		.block {
	  	height: -webkit-calc(100vh - 72px);
	  	height: -moz-calc(100vh - 72px);
	  	height: calc(100vh - 72px);
	  	/*background-color: rgba(90,90,190,0.8);*/
		}
	</style>
	<script>
	function myFunction() {
	    document.getElementById("myForm").reset();
	}
	</script>

{% if resultsAffiliations %}
<script>
	function initMap() {
		var ox = {lat: 51.752013, lng: -1.257850};
		var map = new google.maps.Map(document.getElementById('map'), {
			zoom: 3,
			center: ox,
			mapTypeId: google.maps.MapTypeId.TERRAIN,
		});
		{% for row in resultsAffiliations %}
			var marker = new google.maps.Marker({
				 position: {lat: {{row.latitude}}, lng: {{row.longitude}}},
				 map: map
			});
			marker['infowindow']  = new google.maps.InfoWindow({
							content: "<h6>{{row.affiliation}}</h6>",
			});
			google.maps.event.addListener(marker, 'click', function() {
					this['infowindow'].open(map, this);
			});
		{% endfor %}
	}
</script>
<script async defer
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDBvDdltwG60Tg-9hY_1DOO2q9g0tojQqc&callback=initMap">
</script>
<style>
	 #map {
		height: 700px;
		width: 100%;
	 }
</style>
{% endif %}

{% if graph %}
<style>
	 #graph {
		height: 800px;
		width: 100%;
	 }
</style>
<script src="http://d3js.org/d3.v2.min.js?2.9.3"></script>
<style>

.link {
  stroke: #aaa;
	stroke-width:1px;
}

</style>
{% endif %}
{% if chartResults %}
<style type="text/css">

svg {
  font-family: "Helvetica Neue", Helvetica;
}

.line {
  fill: none;
  stroke: #000;
  stroke-width: 2px;
}

</style>
{% endif %}
</head>

<body>
	<div class="container-fluid">
		<div class="row">
		  <div class="col-md-8">
				<div>
					&nbsp;
				</div>
				{% if errors %}
					{% for error in errors %}
						<div class="alert alert-danger">
							<strong>Error!</strong> {{ error }}
						</div>
					{% endfor %}
				{% else %}
					{% if warnings %}
						{% for warning in warnings %}
							<div class="alert alert-warning">
								<strong>Warning!</strong> {{ warning }}
							</div>
							{% endfor %}
					{% else %}
						{% if resultsAffiliations %}
							<div id="map"></div>
						{% else %}
							{% if graph %}
							<div id="graph"></div>
							<script>

							var graphData = {{ graph|safe }};
							var width = document.getElementById('graph').clientWidth
							    height = document.getElementById('graph').clientHeight
							var force = d3.layout.force()
							    .gravity(.05)
							    .distance(100)
							    .charge(-500)
							    .size([width, height]);


							var svg = d3.select("#graph").append("svg")
							    .attr("width", width)
							    .attr("height", height);
							    force
							        .nodes(graphData.nodes)
							        .links(graphData.links)
							        .start();

							    var link = svg.selectAll(".link")
							        .data(graphData.links)
							        .enter().append("line")
							        .attr("class", "link")
							        .style("stroke-width", function(d) { return Math.sqrt(d.weight); });

							    var node = svg.selectAll(".node")
							        .data(graphData.nodes)
							        .enter().append("g")
							        .attr("class", "node")
											.on("click", function(d){
												if(d.group > 1){
													//console.log(d.titles[0]);
													alert(d.titles.join(". "));
												}
											})
											.style("fill", function (d) {
												switch(d.group){
													case 0:
														return '#FF0000'
													case 1:
														return '#14a7e0'
													case 2:
														return '#2774c4'
													case 3:
														return '#3749ac'
													case 4:
														return '#62486b'
													default:
														return '#1f77b4';
												}
											})
							        .call(force.drag);

							    node.append("circle")
							        .attr("r", function(d) { return d.size });

							    node.append("text")
							        .attr("dx", 12)
							        .attr("dy", ".35em")
							        .text(function(d) { return d.id });

									node.append("id")
											.text(function(d) { return d.titles[0]});

							    force.on("tick", function() {
							      link.attr("x1", function(d) { return d.source.x; })
							          .attr("y1", function(d) { return d.source.y; })
							          .attr("x2", function(d) { return d.target.x; })
							          .attr("y2", function(d) { return d.target.y; });

							      node.attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; });
							    });

							</script>
							{% if rawData %}
							<div class="container-fluid block">
									<h3>Query results:</h3>
									<table class="table table-striped">
									  <thead>
									    <tr>
									      <th scope="col">Title</th>
									      <th scope="col">Author</th>
									      <th scope="col">Year</th>
									      <th scope="col">ID</th>
									    </tr>
									  </thead>
									  <tbody>
										{% for row in rawData %}
									    <tr>
									      <td><a href="/pubDetails?idPub={{ row.id_publication }}">{{ row.title }}</a></td>
									      <td>{{ row.author_name }}</td>
									      <td>{{ row.publication_year }}</td>
									      <td>{{ row.cosyne_id }}</td>
											</tr>
										{% endfor %}
									  </tbody>
									</table>
							</div>
							{% endif %}
							{% else %}
								{% if chartResults %}
								<div id="chart"></div>
								<script src="//d3js.org/d3.v3.min.js"></script>
								<script>
								var chartData = {{ chartResults|safe }};

								var m = [20, 20, 30, 20],
								    w = 960 - m[1] - m[3],
								    h = 500 - m[0] - m[2];

								var x,
								    y,
								    duration = 1500,
								    delay = 500;

								var color = d3.scale.category10();

								//var svg = d3.select("body").append("svg")
								var svg = d3.select("#chart").append("svg")
								    .attr("width", w + m[1] + m[3])
								    .attr("height", h + m[0] + m[2])
								  .append("g")
								    .attr("transform", "translate(" + m[3] + "," + m[0] + ")");

								var stocks,
								    symbols;

								// A line generator, for the dark stroke.
								var line = d3.svg.line()
								    .interpolate("basis")
								    .x(function(d) { return x(d.date); })
								    .y(function(d) { return y(d.price); });

								// A line generator, for the dark stroke.var chartData = {{ chartResults|safe }};
								var axis = d3.svg.line()
								    .interpolate("basis")
								    .x(function(d) { return x(d.date); })
								    .y(h);

								// A area generator, for the dark stroke.
								var area = d3.svg.area()
								    .interpolate("basis")
								    .x(function(d) { return x(d.date); })
								    .y1(function(d) { return y(d.price); });


								////
								var parse = d3.time.format("%Y").parse;

								// Nest stock values by symbol.
								symbols = d3.nest()
										.key(function(d) { return d.symbol; })
										.entries(stocks = chartData);

								// Parse dates and numbers. We assume values are sorted by date.
								// Also compute the maximum price per symbol, needed for the y-domain.
								symbols.forEach(function(s) {
									s.values.forEach(function(d) { d.date = parse(d.date); d.price = +d.price; });
									s.maxPrice = d3.max(s.values, function(d) { return d.price; });
									s.sumPrice = d3.sum(s.values, function(d) { return d.price; });
								});

								// Sort by maximum price, descending.
								symbols.sort(function(a, b) { return b.maxPrice - a.maxPrice; });

								var g = svg.selectAll("g")
										.data(symbols)
									.enter().append("g")
										.attr("class", "symbol");

								setTimeout(lines, duration);

								////

								function lines() {
								  x = d3.time.scale().range([0, w - 60]);
								  y = d3.scale.linear().range([h / 4 - 20, 0]);

								  // Compute the minimum and maximum date across symbols.
								  x.domain([
								    d3.min(symbols, function(d) { return d.values[0].date; }),
								    d3.max(symbols, function(d) { return d.values[d.values.length - 1].date; })
								  ]);

								  var g = svg.selectAll(".symbol")
								      .attr("transform", function(d, i) { return "translate(0," + (i * h / 4 + 10) + ")"; });

								  g.each(function(d) {
								    var e = d3.select(this);

								    e.append("path")
								        .attr("class", "line");

								    e.append("circle")
								        .attr("r", 5)
								        .style("fill", function(d) { return color(d.key); })
								        .style("stroke", "#000")
								        .style("stroke-width", "2px");

								    e.append("text")
								        .attr("x", 12)
								        .attr("dy", ".31em")
								        .text(d.key);
								  });

								  function draw(k) {
								    g.each(function(d) {
								      var e = d3.select(this);
								      y.domain([0, d.maxPrice]);

								      e.select("path")
								          .attr("d", function(d) { return line(d.values.slice(0, k + 1)); });

								      e.selectAll("circle, text")
								          .data(function(d) { return [d.values[k], d.values[k]]; })
								          .attr("transform", function(d) { return "translate(" + x(d.date) + "," + y(d.price) + ")"; });
								    });
								  }

								  var k = 1, n = symbols[0].values.length;
								  d3.timer(function() {
								    draw(k);
								    if ((k += 2) >= n - 1) {
								      draw(n - 1);
								      setTimeout(horizons, 500);
								      return true;
								    }
								  });
								}

								function horizons() {
								  svg.insert("defs", ".symbol")
								    .append("clipPath")
								      .attr("id", "clip")
								    .append("rect")
								      .attr("width", w)
								      .attr("height", h / 4 - 20);

								  var color = d3.scale.ordinal()
								      .range(["#c6dbef", "#9ecae1", "#6baed6"]);

								  var g = svg.selectAll(".symbol")
								      .attr("clip-path", "url(#clip)");

								  area
								      .y0(h / 4 - 20);

								  g.select("circle").transition()
								      .duration(duration)
								      .attr("transform", function(d) { return "translate(" + (w - 60) + "," + (-h / 4) + ")"; })
								      .remove();

								  g.select("text").transition()
								      .duration(duration)
								      .attr("transform", function(d) { return "translate(" + (w - 60) + "," + (h / 4 - 20) + ")"; })
								      .attr("dy", "0em");

								  g.each(function(d) {
								    y.domain([0, d.maxPrice]);

								    d3.select(this).selectAll(".area")
								        .data(d3.range(3))
								      .enter().insert("path", ".line")
								        .attr("class", "area")
								        .attr("transform", function(d) { return "translate(0," + (d * (h / 4 - 20)) + ")"; })
								        .attr("d", area(d.values))
								        .style("fill", function(d, i) { return color(i); })
								        .style("fill-opacity", 1e-6);

								    y.domain([0, d.maxPrice / 3]);

								    d3.select(this).selectAll(".line").transition()
								        .duration(duration)
								        .attr("d", line(d.values))
								        .style("stroke-opacity", 1e-6);

								    d3.select(this).selectAll(".area").transition()
								        .duration(duration)
								        .style("fill-opacity", 1)
								        .attr("d", area(d.values))
								        .each("end", function() { d3.select(this).style("fill-opacity", null); });
								  });

								  setTimeout(areas, duration + delay);
								}

								function areas() {
								  var g = svg.selectAll(".symbol");

								  axis
								      .y(h / 4 - 21);

								  g.select(".line")
								      .attr("d", function(d) { return axis(d.values); });

								  g.each(function(d) {
								    y.domain([0, d.maxPrice]);

								    d3.select(this).select(".line").transition()
								        .duration(duration)
								        .style("stroke-opacity", 1)
								        .each("end", function() { d3.select(this).style("stroke-opacity", null); });

								    d3.select(this).selectAll(".area")
								        .filter(function(d, i) { return i; })
								      .transition()
								        .duration(duration)
								        .style("fill-opacity", 1e-6)
								        .attr("d", area(d.values))
								        .remove();

								    d3.select(this).selectAll(".area")
								        .filter(function(d, i) { return !i; })
								      .transition()
								        .duration(duration)
								        .style("fill", color(d.key))
								        .attr("d", area(d.values));
								  });

								  svg.select("defs").transition()
								      .duration(duration)
								      .remove();

								  g.transition()
								      .duration(duration)
								      .each("end", function() { d3.select(this).attr("clip-path", null); });

								  setTimeout(stackedArea, duration + delay);
								}

								function stackedArea() {
								  var stack = d3.layout.stack()
								      .values(function(d) { return d.values; })
								      .x(function(d) { return d.date; })
								      .y(function(d) { return d.price; })
								      .out(function(d, y0, y) { d.price0 = y0; })
								      .order("reverse");

								  stack(symbols);

								  y
								      .domain([0, d3.max(symbols[0].values.map(function(d) { return d.price + d.price0; }))])
								      .range([h, 0]);

								  line
								      .y(function(d) { return y(d.price0); });

								  area
								      .y0(function(d) { return y(d.price0); })
								      .y1(function(d) { return y(d.price0 + d.price); });

								  var t = svg.selectAll(".symbol").transition()
								      .duration(duration)
								      .attr("transform", "translate(0,0)")
								      .each("end", function() { d3.select(this).attr("transform", null); });

								  t.select("path.area")
								      .attr("d", function(d) { return area(d.values); });

								  t.select("path.line")
								      .style("stroke-opacity", function(d, i) { return i < 3 ? 1e-6 : 1; })
								      .attr("d", function(d) { return line(d.values); });

								  t.select("text")
								      .attr("transform", function(d) { d = d.values[d.values.length - 1]; return "translate(" + (w - 60) + "," + y(d.price / 2 + d.price0) + ")"; });

								  setTimeout(streamgraph, duration + delay);
								}

								function streamgraph() {
								  var stack = d3.layout.stack()
								      .values(function(d) { return d.values; })
								      .x(function(d) { return d.date; })
								      .y(function(d) { return d.price; })
								      .out(function(d, y0, y) { d.price0 = y0; })
								      .order("reverse")
								      .offset("wiggle");

								  stack(symbols);

								  line
								      .y(function(d) { return y(d.price0); });

								  var t = svg.selectAll(".symbol").transition()
								      .duration(duration);

								  t.select("path.area")
								      .attr("d", function(d) { return area(d.values); });

								  t.select("path.line")
								      .style("stroke-opacity", 1e-6)
								      .attr("d", function(d) { return line(d.values); });

								  t.select("text")
								      .attr("transform", function(d) { d = d.values[d.values.length - 1]; return "translate(" + (w - 60) + "," + y(d.price / 2 + d.price0) + ")"; });

								  setTimeout(overlappingArea, duration + delay);
								}

								function overlappingArea() {
								  var g = svg.selectAll(".symbol");

								  line
								      .y(function(d) { return y(d.price0 + d.price); });

								  g.select(".line")
								      .attr("d", function(d) { return line(d.values); });

								  y
								      .domain([0, d3.max(symbols.map(function(d) { return d.maxPrice; }))])
								      .range([h, 0]);

								  area
								      .y0(h)
								      .y1(function(d) { return y(d.price); });

								  line
								      .y(function(d) { return y(d.price); });

								  var t = g.transition()
								      .duration(duration);

								  t.select(".line")
								      .style("stroke-opacity", 1)
								      .attr("d", function(d) { return line(d.values); });

								  t.select(".area")
								      .style("fill-opacity", .5)
								      .attr("d", function(d) { return area(d.values); });

								  t.select("text")
								      .attr("dy", ".31em")
								      .attr("transform", function(d) { d = d.values[d.values.length - 1]; return "translate(" + (w - 60) + "," + y(d.price) + ")"; });

								  svg.append("line")
								      .attr("class", "line")
								      .attr("x1", 0)
								      .attr("x2", w - 60)
								      .attr("y1", h)
								      .attr("y2", h)
								      .style("stroke-opacity", 1e-6)
								    .transition()
								      .duration(duration)
								      .style("stroke-opacity", 1);

								  setTimeout(groupedBar, duration + delay);
								}

								function groupedBar() {
								  x = d3.scale.ordinal()
								      .domain(symbols[0].values.map(function(d) { return d.date; }))
								      .rangeBands([0, w - 60], .1);

								  var x1 = d3.scale.ordinal()
								      .domain(symbols.map(function(d) { return d.key; }))
								      .rangeBands([0, x.rangeBand()]);

								  var g = svg.selectAll(".symbol");

								  var t = g.transition()
								      .duration(duration);

								  t.select(".line")
								      .style("stroke-opacity", 1e-6)
								      .remove();

								  t.select(".area")
								      .style("fill-opacity", 1e-6)
								      .remove();

								  g.each(function(p, j) {
								    d3.select(this).selectAll("rect")
								        .data(function(d) { return d.values; })
								      .enter().append("rect")
								        .attr("x", function(d) { return x(d.date) + x1(p.key); })
								        .attr("y", function(d) { return y(d.price); })
								        .attr("width", x1.rangeBand())
								        .attr("height", function(d) { return h - y(d.price); })
								        .style("fill", color(p.key))
								        .style("fill-opacity", 1e-6)
								      .transition()
								        .duration(duration)
								        .style("fill-opacity", 1);
								  });

								  setTimeout(stackedBar, duration + delay);
								}

								function stackedBar() {
								  x.rangeRoundBands([0, w - 60], .1);

								  var stack = d3.layout.stack()
								      .values(function(d) { return d.values; })
								      .x(function(d) { return d.date; })
								      .y(function(d) { return d.price; })
								      .out(function(d, y0, y) { d.price0 = y0; })
								      .order("reverse");

								  var g = svg.selectAll(".symbol");

								  stack(symbols);

								  y
								      .domain([0, d3.max(symbols[0].values.map(function(d) { return d.price + d.price0; }))])
								      .range([h, 0]);

								  var t = g.transition()
								      .duration(duration / 2);

								  t.select("text")
								      .delay(symbols[0].values.length * 10)
								      .attr("transform", function(d) { d = d.values[d.values.length - 1]; return "translate(" + (w - 60) + "," + y(d.price / 2 + d.price0) + ")"; });

								  t.selectAll("rect")
								      .delay(function(d, i) { return i * 10; })
								      .attr("y", function(d) { return y(d.price0 + d.price); })
								      .attr("height", function(d) { return h - y(d.price); })
								      .each("end", function() {
								        d3.select(this)
								            .style("stroke", "#fff")
								            .style("stroke-opacity", 1e-6)
								          .transition()
								            .duration(duration / 2)
								            .attr("x", function(d) { return x(d.date); })
								            .attr("width", x.rangeBand())
								            .style("stroke-opacity", 1);
								      });

								  setTimeout(transposeBar, duration + symbols[0].values.length * 10 + delay);
								}

								function transposeBar() {
								  x
								      .domain(symbols.map(function(d) { return d.key; }))
								      .rangeRoundBands([0, w], .2);

								  y
								      .domain([0, d3.max(symbols.map(function(d) { return d3.sum(d.values.map(function(d) { return d.price; })); }))]);

								  var stack = d3.layout.stack()
								      .x(function(d, i) { return i; })
								      .y(function(d) { return d.price; })
								      .out(function(d, y0, y) { d.price0 = y0; });

								  stack(d3.zip.apply(null, symbols.map(function(d) { return d.values; }))); // transpose!

								  var g = svg.selectAll(".symbol");

								  var t = g.transition()
								      .duration(duration / 2);

								  t.selectAll("rect")
								      .delay(function(d, i) { return i * 10; })
								      .attr("y", function(d) { return y(d.price0 + d.price) - 1; })
								      .attr("height", function(d) { return h - y(d.price) + 1; })
								      .attr("x", function(d) { return x(d.symbol); })
								      .attr("width", x.rangeBand())
								      .style("stroke-opacity", 1e-6);

								  t.select("text")
								      .attr("x", 0)
								      .attr("transform", function(d) { return "translate(" + (x(d.key) + x.rangeBand() / 2) + "," + h + ")"; })
								      .attr("dy", "1.31em")
								      .each("end", function() { d3.select(this).attr("x", null).attr("text-anchor", "middle"); });

								  svg.select("line").transition()
								      .duration(duration)
								      .attr("x2", w);

								  setTimeout(donut,  duration / 2 + symbols[0].values.length * 10 + delay);
								}

								function donut() {
								  var g = svg.selectAll(".symbol");

								  g.selectAll("rect").remove();

								  var pie = d3.layout.pie()
								      .value(function(d) { return d.sumPrice; });

								  var arc = d3.svg.arc();

								  g.append("path")
								      .style("fill", function(d) { return color(d.key); })
								      .data(function() { return pie(symbols); })
								    .transition()
								      .duration(duration)
								      .tween("arc", arcTween);

								  g.select("text").transition()
								      .duration(duration)
								      .attr("dy", ".31em");

								  svg.select("line").transition()
								      .duration(duration)
								      .attr("y1", 2 * h)
								      .attr("y2", 2 * h)
								      .remove();

								  function arcTween(d) {
								    var path = d3.select(this),
								        text = d3.select(this.parentNode.appendChild(this.previousSibling)),
								        x0 = x(d.data.key),
								        y0 = h - y(d.data.sumPrice);

								    return function(t) {
								      var r = h / 2 / Math.min(1, t + 1e-3),
								          a = Math.cos(t * Math.PI / 2),
								          xx = (-r + (a) * (x0 + x.rangeBand()) + (1 - a) * (w + h) / 2),
								          yy = ((a) * h + (1 - a) * h / 2),
								          f = {
								            innerRadius: r - x.rangeBand() / (2 - a),
								            outerRadius: r,
								            startAngle: a * (Math.PI / 2 - y0 / r) + (1 - a) * d.startAngle,
								            endAngle: a * (Math.PI / 2) + (1 - a) * d.endAngle
								          };

								      path.attr("transform", "translate(" + xx + "," + yy + ")");
								      path.attr("d", arc(f));
								      text.attr("transform", "translate(" + arc.centroid(f) + ")translate(" + xx + "," + yy + ")rotate(" + ((f.startAngle + f.endAngle) / 2 + 3 * Math.PI / 2) * 180 / Math.PI + ")");
								    };
								  }

								  setTimeout(donutExplode, duration + delay);
								}

								function donutExplode() {
								  var r0a = h / 2 - x.rangeBand() / 2,
								      r1a = h / 2,
								      r0b = 2 * h - x.rangeBand() / 2,
								      r1b = 2 * h,
								      arc = d3.svg.arc();

								  svg.selectAll(".symbol path")
								      .each(transitionExplode);

								  function transitionExplode(d, i) {
								    d.innerRadius = r0a;
								    d.outerRadius = r1a;
								    d3.select(this).transition()
								        .duration(duration / 2)
								        .tween("arc", tweenArc({
								          innerRadius: r0b,
								          outerRadius: r1b
								        }));
								  }

								  function tweenArc(b) {
								    return function(a) {
								      var path = d3.select(this),
								          text = d3.select(this.nextSibling),
								          i = d3.interpolate(a, b);
								      for (var key in b) a[key] = b[key]; // update data
								      return function(t) {
								        var a = i(t);
								        path.attr("d", arc(a));
								        text.attr("transform", "translate(" + arc.centroid(a) + ")translate(" + w / 2 + "," + h / 2 +")rotate(" + ((a.startAngle + a.endAngle) / 2 + 3 * Math.PI / 2) * 180 / Math.PI + ")");
								      };
								    }
								  }

								  setTimeout(function() {
								    svg.selectAll("*").remove();
								    svg.selectAll("g").data(symbols).enter().append("g").attr("class", "symbol");
								    lines();
								  }, duration);
								}

								</script>

								{% else %}
									<div class="alert alert-info">
										<strong>Query me!</strong>
									</div>
								{% endif %}
							{% endif %}
						{% endif %}
					{% endif %}
				{% endif %}
			</div>
		  <div class="col-md-4" style="background-color: #a7d7ff">
					<h1>Neurotheory Genealogy<br>
					<small>Search:</small></h1>
					<div class="container-fluid block">
						<!-- Starts form -->
						<form action="test" method="post" id="myForm">
							{% csrf_token %}
							<div class="form-group">
						 		<label for="publicationForm">Publication</label>
						    <input type="text" name="publicationForm" id="publicationForm" class="form-control" placeholder="Publication" {% if publicationForm %} value="{{ publicationForm }}" {% endif %} disabled>
						    <div class="radio">
						    	<label class="radio-inline">
						      	<input type="radio" name="publicationOption" id="publicationOptionIn" value="in" {% if publicationOption and publicationOption == 'in' %} checked {% endif %} disabled> query-by
						      </label>
						      <label class="radio-inline">
						        <input type="radio" name="publicationOption" id="publicationOptionOut" value="out" {% if publicationOption and publicationOption == 'out' %} checked {% endif %} disabled> return
						      </label>
						    </div>
						  </div>
							<div class="form-group">
						 		<label for="authorForm">Author</label>
						    <input type="text" name="authorForm" id="authorForm" class="form-control" placeholder="Author" {% if authorForm %} value="{{ authorForm }}" {% endif %}>
						    <div class="radio">
						    	<label class="radio-inline">
						      	<input type="radio" name="authorOption" id="authorOptionIn" value="in" {% if authorOption and authorOption == 'in' %} checked {% endif %}> query-by
						      </label>
						      <label class="radio-inline">
						        <input type="radio" name="authorOption" id="authorOptionOut" value="out" {% if authorOption and authorOption == 'out' %} checked {% endif %}> return
						      </label>
						    </div>
						  </div>
							<div class="form-group">
						 		<label for="keywordForm">Keyword</label>
						    <input type="text" name="keywordForm" id="keywordForm" class="form-control" placeholder="Keyword" {% if keywordForm %} value="{{ keywordForm }}" {% endif %}>
						    <div class="radio">
						    	<label class="radio-inline">
						      	<input type="radio" name="keywordOption" id="keywordOptionIn" value="in" {% if keywordOption and keywordOption == 'in' %} checked {% endif %}> query-by
						      </label>
						      <label class="radio-inline">
						        <input type="radio" name="keywordOption" id="keywordOptionOut" value="out" {% if keywordOption and keywordOption == 'out' %} checked {% endif %}> return
						      </label>
						    </div>
						  </div>
							<div class="form-group">
						 		<label for="yearForm">Year(s)</label>
								<label class="checkbox-inline">
								  <input type="checkbox" name="yearForm" id="yearForm1" value="2012" {% if '2012' in yearForm %} checked {% endif %}> 2012
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" name="yearForm" id="yearForm2" value="2013" {% if '2013' in yearForm %} checked {% endif %}> 2013
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" name="yearForm" id="yearForm3" value="2014" {% if '2014' in yearForm %} checked {% endif %}> 2014
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" name="yearForm" id="yearForm4" value="2015" {% if '2015' in yearForm %} checked {% endif %}> 2015
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" name="yearForm" id="yearForm5" value="2016" {% if '2016' in yearForm %} checked {% endif %}> 2016
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" name="yearForm" id="yearForm6" value="2017" {% if '2017' in yearForm %} checked {% endif %}> 2017
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" name="yearForm" id="yearForm7" value="2018" {% if '2018' in yearForm %} checked {% endif %}> 2018
								</label>
						    <div class="radio">
						    	<label class="radio-inline">
						      	<input type="radio" name="yearOption" id="yearOptionIn" value="in" {% if yearOption and yearOption == 'in' %} checked {% endif %}> query-by
						      </label>
						      <label class="radio-inline">
						        <input type="radio" name="yearOption" id="yearOptionOut" value="out" {% if yearOption and yearOption == 'out' %} checked {% endif %}> return
						      </label>
						    </div>
						  </div>
							<div class="form-group">
						 		<label for="affiliationForm">Affiliation</label>
								<select name="affiliationForm" class="form-control">
										<option value="0"> -- choose -- </option>
									{% if affiliations %}
										{% for affiliation in affiliations %}
  										<option value="{{ affiliation.id_affiliation }}" {% if affiliationForm and affiliationForm == affiliation.id_affiliation|stringformat:"s" %} selected {% endif %}>{{ affiliation.affiliation }}</option>
										{% endfor %}
									{% endif %}
  							</select>
								<div class="radio">
						    	<label class="radio-inline">
						      	<input type="radio" name="affiliationOption" id="affiliationOptionIn" value="in" {% if affiliationOption and affiliationOption == 'in' %} checked {% endif %}> query-by
						      </label>
						      <label class="radio-inline">
						        <input type="radio" name="affiliationOption" id="affiliationOptionOut" value="out" {% if affiliationOption and affiliationOption == 'out' %} checked {% endif %}> return
						      </label>
						    </div>
						  </div>
							<div class="form-group">
						 		<label for="genderForm">Gender</label>
								<select name="genderForm" class="form-control">
									<option value="0"> -- choose -- </option>
  								<option value="male" {% if genderForm and genderForm == 'male' %} selected {% endif %}>Male</option>
  								<option value="female" {% if genderForm and genderForm == 'female' %} selected {% endif %}>Female</option>
  							</select>
						    <div class="radio">
						    	<label class="radio-inline">
						      	<input type="radio" name="genderOption" id="genderOptionIn" value="in" {% if genderOption and genderOption == 'in' %} checked {% endif %}> query-by
						      </label>
						      <label class="radio-inline">
						        <input type="radio" name="genderOption" id="genderOptionOut" value="out" {% if genderOption and genderOption == 'out' %} checked {% endif %}> return
						      </label>
						    </div>
						  </div>
							<button type="submit" class="btn btn-default">Submit</button>
							<a href="test" class="btn btn-default">Reset</a>
						</form>
						<!-- Ends form -->
					</div>
					<div class="container-fluid block">&nbsp;</div>
			</div>
		</div>
	</div>
</body>

</html>
